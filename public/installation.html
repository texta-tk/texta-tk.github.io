
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Installation in Docker &#8212; TEXTA Toolkit 2 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Using TEXTA Toolkit" href="workflow.html" />
    <link rel="prev" title="&lt;no title&gt;" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="installation-in-docker">
<span id="installation"></span><h1>Installation in Docker<a class="headerlink" href="#installation-in-docker" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently all installation examples for system dependencies are only shown for Debian-based systems.</p>
</div>
<div class="section" id="install-docker">
<h2>Install Docker<a class="headerlink" href="#install-docker" title="Permalink to this headline">¶</a></h2>
<p>The easiest way to run TEXTA Toolkit is to use our prebuilt Docker images from our registries. For doing so, one needs to install <em>Docker</em> and <em>docker-compose</em>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt-get update
sudo apt-get install docker docker-compose -y
</pre></div>
</div>
</div>
<div class="section" id="configure-docker-compose">
<h2>Configure docker-compose<a class="headerlink" href="#configure-docker-compose" title="Permalink to this headline">¶</a></h2>
<p>We are using <em>docker-compose</em> to build an ecosystem of services to support our needs. This is all defined in a file called <em>docker-compose.yaml</em>.
To successfully run TEXTA Toolkit we need to define following services:</p>
<ul class="simple">
<li><p>Elasticsearch for storing the documents (one can also run it without Docker)</p></li>
<li><p>MySQL for storing user and project data (can also be run without Docker)</p></li>
<li><p>TEXTA Toolkit RESTful API for backend: docker.texta.ee/texta/texta-rest:latest</p></li>
<li><p>TEXTA Toolkit Angular frontend: docker.texta.ee/texta/texta-rest-front:latest</p></li>
</ul>
<p>For executing aforementioned services we have preconfigured an example <em>docker-compose.yaml</em> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">version</span><span class="p">:</span> <span class="s1">&#39;3&#39;</span>

<span class="n">services</span><span class="p">:</span>
    <span class="n">elasticsearch</span><span class="p">:</span>
        <span class="n">container_name</span><span class="p">:</span> <span class="n">elasticsearch</span>
        <span class="n">restart</span><span class="p">:</span> <span class="n">on</span><span class="o">-</span><span class="n">failure</span>
        <span class="n">image</span><span class="p">:</span> <span class="n">docker</span><span class="o">.</span><span class="n">elastic</span><span class="o">.</span><span class="n">co</span><span class="o">/</span><span class="n">elasticsearch</span><span class="o">/</span><span class="n">elasticsearch</span><span class="o">-</span><span class="n">oss</span><span class="p">:</span><span class="mf">6.7</span><span class="o">.</span><span class="mi">2</span>
        <span class="n">ports</span><span class="p">:</span>
        <span class="o">-</span> <span class="mi">9200</span><span class="p">:</span><span class="mi">9200</span>
        <span class="n">environment</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">bootstrap</span><span class="o">.</span><span class="n">memory_lock</span><span class="o">=</span><span class="n">true</span>
        <span class="n">ulimits</span><span class="p">:</span>
        <span class="n">memlock</span><span class="p">:</span>
            <span class="n">soft</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">hard</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">volumes</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">elastic</span><span class="o">-</span><span class="n">data</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">elasticsearch</span><span class="o">/</span><span class="n">data</span>

    <span class="n">mysql</span><span class="p">:</span>
        <span class="n">container_name</span><span class="p">:</span> <span class="n">mysql</span>
        <span class="n">image</span><span class="p">:</span> <span class="n">mysql</span><span class="p">:</span><span class="n">latest</span>
        <span class="n">ports</span><span class="p">:</span>
        <span class="o">-</span> <span class="mi">3306</span><span class="p">:</span><span class="mi">3306</span>
        <span class="n">env_file</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">env</span>

    <span class="n">toolkit</span><span class="o">-</span><span class="n">rest</span><span class="p">:</span>
        <span class="n">container_name</span><span class="p">:</span> <span class="n">toolkit</span><span class="o">-</span><span class="n">rest</span>
        <span class="n">image</span><span class="p">:</span> <span class="n">docker</span><span class="o">.</span><span class="n">texta</span><span class="o">.</span><span class="n">ee</span><span class="o">/</span><span class="n">texta</span><span class="o">/</span><span class="n">texta</span><span class="o">-</span><span class="n">rest</span><span class="p">:</span><span class="n">latest</span>
        <span class="n">ports</span><span class="p">:</span>
        <span class="o">-</span> <span class="mi">8000</span><span class="p">:</span><span class="mi">80</span>
        <span class="n">env_file</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">env</span>
        <span class="n">restart</span><span class="p">:</span> <span class="n">always</span>
        <span class="n">depends_on</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">mysql</span>
        <span class="o">-</span> <span class="n">elasticsearch</span>
        <span class="n">volumes</span><span class="p">:</span>
        <span class="o">-</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">data</span><span class="o">-</span><span class="n">volumes</span><span class="o">/</span><span class="n">toolkit</span><span class="o">-</span><span class="n">data</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">texta</span><span class="o">-</span><span class="n">rest</span><span class="o">/</span><span class="n">data</span>

    <span class="n">toolkit</span><span class="o">-</span><span class="n">front</span><span class="p">:</span>
        <span class="n">container_name</span><span class="p">:</span> <span class="n">toolkit</span><span class="o">-</span><span class="n">front</span>
        <span class="n">image</span><span class="p">:</span> <span class="n">docker</span><span class="o">.</span><span class="n">texta</span><span class="o">.</span><span class="n">ee</span><span class="o">/</span><span class="n">texta</span><span class="o">/</span><span class="n">texta</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">front</span><span class="p">:</span><span class="n">latest</span>
        <span class="n">ports</span><span class="p">:</span>
        <span class="o">-</span> <span class="mi">4200</span><span class="p">:</span><span class="mi">80</span>
        <span class="n">restart</span><span class="p">:</span> <span class="n">always</span>
        <span class="n">env_file</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">env</span>

<span class="n">volumes</span><span class="p">:</span>
<span class="n">elastic</span><span class="o">-</span><span class="n">data</span><span class="p">:</span>
<span class="n">toolkit</span><span class="o">-</span><span class="n">data</span><span class="p">:</span>
<span class="n">mysql</span><span class="p">:</span>
</pre></div>
</div>
<p>The compose file is used in combination with <em>env</em> file containing environment variables needed for operating TEXTA Toolkit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TEXTA_ES_URL</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">elasticsearch</span><span class="p">:</span><span class="mi">9200</span>
<span class="n">TEXTA_DEBUG</span><span class="o">=</span><span class="kc">False</span>

<span class="n">DJANGO_DATABASE_ENGINE</span><span class="o">=</span><span class="n">django</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">mysql</span>
<span class="n">DJANGO_DATABASE_NAME</span><span class="o">=</span><span class="n">docker</span>
<span class="n">DJANGO_DATABASE_USER</span><span class="o">=</span><span class="n">docker</span>
<span class="n">DJANGO_DATABASE_PASSWORD</span><span class="o">=</span><span class="n">docker</span>
<span class="n">DJANGO_DATABASE_HOST</span><span class="o">=</span><span class="n">mysql</span>
</pre></div>
</div>
</div>
<div class="section" id="run-texta-toolkit">
<h2>Run TEXTA Toolkit<a class="headerlink" href="#run-texta-toolkit" title="Permalink to this headline">¶</a></h2>
<p>With the <strong>docker-compose.yaml</strong> and <strong>env</strong> files present and accounted for,
let’s pull the images and start the services by executing the following commands in the same directory with <em>docker-compose.yaml</em> and <em>env</em>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker-compose pull
docker-compose up
</pre></div>
</div>
<p>For running in detached mode, use the <em>-d</em> flag:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker-compose up -d
</pre></div>
</div>
<p>For stopping the services:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker-compose down
</pre></div>
</div>
</div>
</div>
<div class="section" id="installation-for-development">
<h1>Installation for Development<a class="headerlink" href="#installation-for-development" title="Permalink to this headline">¶</a></h1>
<p>If you want to develop TEXTA Toolkit, want more control over how you run it, or seriously dislike Docker, it is also possible to install Toolkit using Anaconda (or Miniconda as shown in following examples).</p>
<div class="section" id="install-miniconda">
<h2>Install Miniconda<a class="headerlink" href="#install-miniconda" title="Permalink to this headline">¶</a></h2>
<p>First we need to download and install Miniconda to manage Python environments.
We choose Miniconda over Anaconda because it’s smaller in size, but Toolkit works well with both.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh
sh Miniconda3-latest-Linux-x86_64.sh
</pre></div>
</div>
<p>Also, let’s put Conda to <strong>PATH</strong> variable:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span> <span class="s1">&#39;export PATH=/path/to/miniconda3/bin:$PATH&#39;</span> &gt;&gt; ~/.bashrc
</pre></div>
</div>
</div>
<div class="section" id="clone-the-repository">
<h2>Clone the Repository<a class="headerlink" href="#clone-the-repository" title="Permalink to this headline">¶</a></h2>
<p>Now, let’s clone the repository and move to <strong>texta-rest</strong> direcory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone https://git.texta.ee/texta/texta-rest
<span class="nb">cd</span> texta-rest
</pre></div>
</div>
</div>
<div class="section" id="build-the-environment">
<h2>Build the Environment<a class="headerlink" href="#build-the-environment" title="Permalink to this headline">¶</a></h2>
<p>Now that we have <strong>environment.yaml</strong> file from the texta-rest repository, let’s use it to build the environment.
After the environment is built, let’s activate it:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda env create -f environment.yaml
conda activate texta-rest
</pre></div>
</div>
</div>
<div class="section" id="migrate-run-toolkit">
<h2>Migrate &amp; Run Toolkit<a class="headerlink" href="#migrate-run-toolkit" title="Permalink to this headline">¶</a></h2>
<p>After the environment has been created and activated, let’s prepare the database:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python migrate.py
</pre></div>
</div>
<p>Finally let’s run the development server:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python manage.py runserver
</pre></div>
</div>
<p>And in another terminal run the Celery worker responsible for asynchronous tasks:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>celery -A toolkit.taskman worker -l info
</pre></div>
</div>
</div>
</div>
<div class="section" id="checking-toolkit-s-health">
<h1>Checking Toolkit’s Health<a class="headerlink" href="#checking-toolkit-s-health" title="Permalink to this headline">¶</a></h1>
<p>For checking the health of a running Toolkit instance, one can access the <strong>/health</strong> endpoint for operating statistics.
The endpoint responds with information abouth the availability of services (e.g. Elasticsearch and TEXTA MLP) and system resources (e.g. disk, memory, GPU usage, etc.).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;elastic&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://elasticsearch:9200&quot;</span><span class="p">,</span>
        <span class="s2">&quot;alive&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;elastic-dev&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cluster_name&quot;</span><span class="p">:</span> <span class="s2">&quot;TEXTA-elastic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cluster_uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;hyho3XLIS4qj9HijALguUA&quot;</span><span class="p">,</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;number&quot;</span><span class="p">:</span> <span class="s2">&quot;6.8.6&quot;</span><span class="p">,</span>
                <span class="s2">&quot;build_flavor&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
                <span class="s2">&quot;build_type&quot;</span><span class="p">:</span> <span class="s2">&quot;deb&quot;</span><span class="p">,</span>
                <span class="s2">&quot;build_hash&quot;</span><span class="p">:</span> <span class="s2">&quot;3d9f765&quot;</span><span class="p">,</span>
                <span class="s2">&quot;build_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-12-13T17:11:52.013738Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;build_snapshot&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
                <span class="s2">&quot;lucene_version&quot;</span><span class="p">:</span> <span class="s2">&quot;7.7.2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;minimum_wire_compatibility_version&quot;</span><span class="p">:</span> <span class="s2">&quot;5.6.0&quot;</span><span class="p">,</span>
                <span class="s2">&quot;minimum_index_compatibility_version&quot;</span><span class="p">:</span> <span class="s2">&quot;5.0.0&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;tagline&quot;</span><span class="p">:</span> <span class="s2">&quot;You Know, for Search&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;mlp&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://texta-mlp:5000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;alive&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;loaded entities&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;/opt/texta-mlp/entity_mapper/data/addresses.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;/opt/texta-mlp/entity_mapper/data/atc.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;/opt/texta-mlp/entity_mapper/data/companies.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;/opt/texta-mlp/entity_mapper/data/substances.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;/opt/texta-mlp/entity_mapper/data/drugs.json&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;service&quot;</span><span class="p">:</span> <span class="s2">&quot;TEXTA MLP&quot;</span><span class="p">,</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.2.1&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.3.10&quot;</span><span class="p">,</span>
    <span class="s2">&quot;disk&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;free&quot;</span><span class="p">:</span> <span class="mf">316.9075050354004</span><span class="p">,</span>
        <span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="mf">1599.4990272521973</span><span class="p">,</span>
        <span class="s2">&quot;used&quot;</span><span class="p">:</span> <span class="mf">1282.5915222167969</span><span class="p">,</span>
        <span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="s2">&quot;GB&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;memory&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;free&quot;</span><span class="p">:</span> <span class="mf">22.222003936767578</span><span class="p">,</span>
        <span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="mf">31.4151611328125</span><span class="p">,</span>
        <span class="s2">&quot;used&quot;</span><span class="p">:</span> <span class="mf">8.80206298828125</span><span class="p">,</span>
        <span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="s2">&quot;GB&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;cpu&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;percent&quot;</span><span class="p">:</span> <span class="mf">0.8</span>
    <span class="p">},</span>
    <span class="s2">&quot;gpu&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;devices&quot;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">},</span>
    <span class="s2">&quot;active_tasks&quot;</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">}</span>
</pre></div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">TEXTA Toolkit</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation in Docker</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#install-docker">Install Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configure-docker-compose">Configure docker-compose</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-texta-toolkit">Run TEXTA Toolkit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#installation-for-development">Installation for Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#install-miniconda">Install Miniconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="#clone-the-repository">Clone the Repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="#build-the-environment">Build the Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#migrate-run-toolkit">Migrate &amp; Run Toolkit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#checking-toolkit-s-health">Checking Toolkit’s Health</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Using TEXTA Toolkit</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">&lt;no title&gt;</a></li>
      <li>Next: <a href="workflow.html" title="next chapter">Using TEXTA Toolkit</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020 TEXTA.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/installation.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>